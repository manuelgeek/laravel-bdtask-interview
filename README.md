<p align="center"><a href="https://laravel.com" target="_blank"><img src="https://raw.githubusercontent.com/laravel/art/master/logo-lockup/5%20SVG/2%20CMYK/1%20Full%20Color/laravel-logolockup-cmyk-red.svg" width="400"></a></p>


## About

This is an Interview Project built with Laravel 8.1
The project uses Seeders and Factories to simulate user data, hence should run in `development` mode

## Set up

`composer install`

`php artisan key:generate`

`cp .env.example .env`

Add database and email configs to `.env`

`php artisan migarate --seed`

start the scheduler

`php artisan schedule:run`

or in crontab to run every minute

`* * * * * php path/to/project/root/artisan schedule:run >> /dev/null 2>&1
`



## 2. Send Emails to users on new random users

all examples in this demo are generated by faker to simulate real News

new news sent to all user email

Email test config for dev: mailtrap


## 3. The Seller

### Register API
#### Url 
added  `google` and `facebook`. Google used in this Demo

POST `http://127.0.0.1:8000/api/v1/social_login/google`

#### Body
```json
{
    "access_token" : "google-access-token-here",
    "user_type" : "B"
}
```
user types allowed: [A, B, C, D, E, F] for this demo

you can generate an access token here https://developers.google.com/oauthplayground/
select Google People API, `user.profile`
get access_token

#### Response 
```json
{
    "token": "1|702PgIlxSg651TuCMWaW2vAx5QbiWWNHZ1ZlUU9E",
    "user": {
        "id": 11,
        "name": "Magak Emmanuel",
        "email": "emashmagak@gmail.com",
        "email_verified_at": null,
        "user_type": "B",
        "created_at": "2020-10-03T09:45:02.000000Z",
        "updated_at": "2020-10-03T09:45:02.000000Z"
    }
}
```

### Sellers Url
#### Url
POST ` http://127.0.0.1:8000/api/v1/sale-made`

#### Header 
`Authorization: Bearer {token}`

#### Body
```json
{
    "amount": 1000
}
```

#### Response 
```json
{
    "data": {
        "amount": 1000,
        "commission": 200,
        "affiliateCommission": 10,
        "user_id": 11,
        "updated_at": "2020-10-03T09:51:28.000000Z",
        "created_at": "2020-10-03T09:51:28.000000Z",
        "id": 1
    }
}
```

### Get Sales
#### Url
GET ` http://127.0.0.1:8000/api/v1/sale-made`

#### Header 
`Authorization: Bearer {token}`

#### Response
```json
{
    "data": {
        "amount": 1000,
        "commission": 200,
        "affiliateCommission": 10,
        "user_id": 11,
        "updated_at": "2020-10-03T09:51:28.000000Z",
        "created_at": "2020-10-03T09:51:28.000000Z",
        "id": 1
    }
}
```

## License

The Laravel framework is open-sourced software licensed under the [MIT license](https://opensource.org/licenses/MIT).
